<?php
/*  
 * Security Antivirus Firewall (wpTools S.A.F.)
 * http://wptools.co/wordpress-security-antivirus-firewall
 * Version:           	2.1.3
 * Build:             	11943
 * Author:            	WpTools
 * Author URI:        	http://wptools.co
 * License:           	License: GNU/GPLv3 http://www.gnu.org/licenses/gpl-3.0.html
 * Date:              	Tue, 01 Nov 2016 09:53:04 GMT
 */

if ( ! defined( 'WPINC' ) )  die;
if ( ! defined( 'ABSPATH' ) ) exit;

class wptsafExtensionMalwareScannerWidget extends wptsafAbstractExtensionWidget{

	public function content(){
		$view = new wptsafView();
		/** @var wptsafExtensionMalwareScannerLog $log */
		$log = $this->extension->getLog();
		$fileStatusState = $log->getStatusState();
		$scanStatusState = $log->getScanStatusState();

		return $view->content(
			$this->extension->getExtensionDir() . 'template/widget.php',
			array(
				'title' => $this->extension->getTitle(),
				'description' => $this->extension->getDescription(),
				'isEnabled' => $this->extension->getSettings()->get('is_enabled'),
				'fileStatuses' => $log::getFileStatuses(),
				'scanStatuses' => $log::getScanStatuses(),
				'fileStatusState' => $fileStatusState,
				'scanStatusState' => $scanStatusState
			)
		);
	}
}
